<div class="wizard">
  <div>
    <!-- Wizard Steps Components -->
    <div class="col col-12">
      <div class="card px-30 py-10 mb-neg5 row">
        <div class="row">
          <h3 class="m-auto">{{title}}</h3>
        </div>
        <hr>

      </div>
      <div *ngIf="errMsg" class="alert alert-danger">{{ errMsg }}</div>

      <div *ngIf="currStep === Step.paymentAmount" class="text-center">
        <canyalib-input-amount [minAmount]="minAmount" [maxAmount]="maxAmount" (amountUpdate)="setAmount($event)"
          (error)="error($event)"></canyalib-input-amount>
      </div>

      <div *ngIf="currStep === Step.paymentSummary">
        <canyalib-payment-summary [amount]="amount" [paymentSummary]="paymentSummary" (error)="error($event)"
          (stepChange)="stepChanger($event)">
        </canyalib-payment-summary>
      </div>

      <div *ngIf="currStep === Step.metamask">
        <!-- <h5>Metamask Checks</h5> -->
        <canyalib-metamask (account)="setAccount($event)"></canyalib-metamask>
      </div>
      <div *ngIf="currStep === Step.balanceCheck">
        <canyalib-loading-status [isLoading]="isLoading" [label]="'Checking CAN balance'"></canyalib-loading-status>
        <div *ngIf="insufficientBalance">
          <h5>Insufficient Balance</h5>
          <p class="wizard-hidden-mobile">You don't have the minimum amount of {{this.amount}} CAN required to complete
            the process.
            <br>Please, buy some CAN and re-check your balance to proceed.</p>
          <p class="wizard-hidden-desktop">Insufficient CAN. Please, buy some CAN and re-check your balance to proceed.</p>
          <canyalib-bancor-wc [isLoading]="isLoading" [balance]="balance" [disableCanEx]="disableCanEx" (valueChange)='stepChanger($event)'
            (check)="checkBalance()"></canyalib-bancor-wc>
        </div>
      </div>

      <div *ngIf="currStep === Step.canexPaymentOptions">
        <canyalib-canex-payment-options (valueChange)='stepChanger($event)' [balance]="balance" [amount]="amount"
          [destinationAddress]='getCanExRecipient()' [userEmail]='userEmail'></canyalib-canex-payment-options>
      </div>

      <div *ngIf="currStep === Step.canexQr">
        <canyalib-canex-qr (valueChange)='stepChanger($event)'></canyalib-canex-qr>
      </div>

      <div *ngIf="currStep === Step.canexProcessing">
        <canyalib-canex-processing (valueChange)='stepChanger($event)' (purchaseComplete)="purchaseComplete()"
          [postBalanceStep]="postBalanceStep"></canyalib-canex-processing>
      </div>

      <div *ngIf="currStep === Step.canexErc20">
        <canyalib-canex-erc20 (valueChange)='stepChanger($event)'></canyalib-canex-erc20>
      </div>

      <div *ngIf="currStep === Step.canexReceipt">
        <canyalib-canex-receipt></canyalib-canex-receipt>
      </div>

      <div *ngIf="currStep === Step.canexError">
        <canyalib-canex-error></canyalib-canex-error>
      </div>

      <div *ngIf="currStep === Step.authorisation">
        <canyalib-payment-authorisation [recipient]="recipient" [onAuthTxHash]="onAuthTxHash" [dAppName]="dAppName"
          [amount]="amount" (error)="error($event)" (success)="notifyPaymentAuthorised($event)"></canyalib-payment-authorisation>
      </div>

      <div *ngIf="currStep === Step.payment">
        <canyalib-payment [recipient]="recipient" [dAppName]="dAppName" [amount]="amount" (error)="error($event)"
          (success)="notifyPaymentCollected($event)"></canyalib-payment>
      </div>

      <div *ngIf="currStep === Step.process">
        <canyalib-process [processName]="postAuthorisationProcessName" [dAppName]="dAppName" [amount]="amount" [error]="errMsg"
          (start)="doStartPostAuthorisationProcess()"></canyalib-process>
      </div>

      <div *ngIf="currStep === Step.confirmation">
        <msg-box [msg]="confirmationDlg" [controls]="confirmationDlg.controls" (action)="finish()"></msg-box>
      </div>
    </div>
  </div>
</div>
